
RNNを用いた正規分布の回帰 keras実装
===

### 何書く
- モチベーション
  - RNNは時系列データを扱うのに適したモデルである(最近はもう流行ってないが)。
  - しかし、RNNも含めてニューラルネットの出力が点であるモデルが多い。
  - 点推定は多くの情報が失われるため、分布推定を行いたい。
  - 分布推定ができたら、異常検知等の枠組みに利用できる。

- データの説明と今回の目的

- 仮定
  - 正規分布を仮定
  - 正規分布のパラメーターは時刻に依存すると仮定


- 損失関数
  - いきなり損失
- モデル
  - 図で説明
  - コードで説明
- 結果
  - いきなり結果

- なぜこの損失関数？


- 経緯、コメント
  - 前回は個々に平均と分散を推定したが今回は同時に推定した
  - 実は前回も同時に推定しようとしたがうまく行かなかった経緯が存在する。
  - しかし頂いたコメントをもとに実装したところうまく行ったので記録に残す
  - 感謝



### 図
- モデルの概要
- 結果をいくつか

### 式
$$
N(y; \mu, \sigma^2)=\dfrac {1}{\sqrt{2\pi\sigma^2}}\exp\biggl\{ -\dfrac {(y-\mu)^2}{2\sigma^2}\biggr\}
$$

負の対数尤度
$$
-\log(N(y; \mu, \sigma^2))= \frac{1}{2}\log(2\pi \sigma^2)  + \frac{(y-\mu)^2}{2\sigma^2}
$$

$$
-\log(N(y; \mu, \sigma^2))= \frac{1}{2}\log(2\pi) + \frac{1}{2}\log(\sigma^2) + \frac{1}{2}\frac{(y-\mu)^2}{\sigma^2}
$$

精度パラメーター \betaを導入

$$
\beta = \frac{1}{\sigma^2}
$$

$$
-\log(N(y; \mu, 1/\beta))= \frac{1}{2}\log(2\pi) + \frac{1}{2}\log(1/\beta) + \frac{1}{2}(y-\mu)^2\beta
$$

$$
-\log(N(y; \mu, 1/\beta))= \frac{1}{2}\log(2\pi) - \frac{1}{2}\log(\beta) + \frac{1}{2}(y-\mu)^2\beta
$$

損失関数に定数項や定数倍は不要

$$
\text{loss} = -\log(\beta) + (y-\mu)^2\beta
$$


